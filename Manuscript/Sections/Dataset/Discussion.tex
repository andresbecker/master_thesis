%% Magic command to compile root document
% !TEX root = ../../thesis.tex
% reset glossary to show full acrs
\glsresetall
% define where the images are
\graphicspath{{./Sections/Dataset/Resources/}}

Besides the preprocessing techniques introduced in section \ref{sec:dataset:data_pp} (clipping and standardization), the following approaches were also tried

\begin{itemize}
  \item Linear scaling using the $98\%$ percentile with and without clipping.
  \item Mean extraction and linear scaling using the $98\%$ percentile with clipping (like standardization, but with the $98\%$ percentile instead of the standard deviation).
  \item $49\%$ percentile extraction and linear scaling using the $98\%$ percentile (no clipping).
\end{itemize}

\noindent This approaches were tried at a per-channel level. However, clipping plus standardization where the prprocessing techniques that showed the best performance. Since we seek the model to predict \gls{tr} base on spacial information, rather than pixel intensity/color, good performance means low \gls{mae} for the \gls{cnn} models, but high \gls{mae} for the linear model (since the linear model is unable to use the spatial information). This indicates that the spatial information encoded in the images of the data set has more influence on the prediction of the model than the information encoded in the colors.

Another aspect of the dataset that is worth to mention, is that more than half cells are in phase $G_1$ (see table \ref{table:data_pp:dataset_dist_cc}), while cells in $S$ phase are less than $30\%$ and around $15\%$ for $G_2$ cells. This causes the model to focus more on correctly predicting the \gls{tr} of $G_1$ cells, than for cells in the other two phases. This happens because $G_1$ cells have more influence on the minimization of the objective function, since it is more likely that the model is fed with $G_1$ cells during training.

As it is shown on figure \ref{fig:dataset:discus:tr_dist}, \gls{tr} of $G_1$ cells is significantly lower than \gls{tr} of $S$ and $G_2$ cells. This, and that cells in different phases are not in the same proportion in the dataset, can cause the model to make a biased prediction when it is fed with a $S$ or $G_2$ cell. Two possible solutions to this problem are, either to add more cells in phases $S$ and $G_2$ to the dataset, or to sample with replacement over the available cells, so the proportion of cells in the three different phases is the same in the dataset. Another possible solution would be to do a weighted loss function based on the cell phase proportions, such that every phase has the same influence on it during training.\fxnote{Discuss with Hannah if this is the correct place to put this.}

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.7\linewidth]{TR_dist.jpg}
  \caption{\gls{tr} distribution separated by cell phase.}
  \label{fig:dataset:discus:tr_dist}
\end{figure}



Talk here about the other augmentation techniques tried.

% TODO: https://www.baseclick.eu/product/5-ethynyl-uridine/ inicates: (EU) is a modified nucleoside that can be used for labeling of nascent RNA inside cells. ....experiments indicate that it will be first integrated in de novo RNA, but we have also observed incorporation into DNA after some incubation time.
% This means that the RNA readouts may be contaminated with DNA if the duration time (30 mins) is to long. Write in the future work that this should be repeated with the dataset where the duration time was 10 mins.
